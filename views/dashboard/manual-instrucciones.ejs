<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/css/colors.css" rel="stylesheet">
    <link href="/css/dashboard.css" rel="stylesheet">
    <%- include('../partials/navbar-styles') %>
    <style>
        :root {
            --primary-color: #0b891b;
            --secondary-color: #28a745;
            --accent-color: #20c997;
            --dark-color: #1a1a1a;
            --light-bg: #f8f9fa;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .manual-container {
            min-height: 100vh;
            padding: 2rem 0;
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 4rem 2rem;
            border-radius: 20px;
            margin-bottom: 3rem;
            box-shadow: 0 10px 40px rgba(11, 137, 27, 0.3);
            position: relative;
            overflow: visible !important;
            animation: fadeInDown 1s ease-out;
        }

        /* Contenedor de Banderas de Idioma - Esquina superior izquierda del banner */
        #languageSwitchContainer {
            position: absolute !important;
            top: 20px !important;
            left: 20px !important;
            z-index: 1000 !important;
            background: #ffffff !important;
            padding: 10px 14px !important;
            border-radius: 25px !important;
            box-shadow: 0 8px 25px rgba(0,0,0,0.5) !important;
            border: 3px solid #0b891b !important;
            display: flex !important;
            align-items: center !important;
            gap: 12px !important;
            justify-content: center !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        /* Banderas de Idioma con Im√°genes */
        .flag-image {
            width: 40px !important;
            height: 28px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            border-radius: 6px !important;
            border: 3px solid transparent !important;
            display: inline-block !important;
            object-fit: cover !important;
            user-select: none !important;
            -webkit-user-select: none !important;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2) !important;
        }

        .flag-image:hover {
            transform: scale(1.2) !important;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4) !important;
        }

        .flag-image.active {
            border-color: #0b891b !important;
            box-shadow: 0 0 0 4px rgba(11, 137, 27, 0.4), 0 4px 10px rgba(0,0,0,0.3) !important;
            transform: scale(1.1) !important;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            z-index: 1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero-logo {
            max-width: 250px;
            height: auto;
            margin-bottom: 1.5rem;
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            animation: pulse 2s ease-in-out infinite;
            object-fit: contain;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .section-card {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease-out;
            animation-fill-mode: both;
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 35px rgba(11, 137, 27, 0.15);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-card:nth-child(1) { animation-delay: 0.1s; }
        .section-card:nth-child(2) { animation-delay: 0.2s; }
        .section-card:nth-child(3) { animation-delay: 0.3s; }
        .section-card:nth-child(4) { animation-delay: 0.4s; }
        .section-card:nth-child(5) { animation-delay: 0.5s; }
        .section-card:nth-child(6) { animation-delay: 0.6s; }

        .section-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            color: white;
            font-size: 2rem;
            box-shadow: 0 5px 15px rgba(11, 137, 27, 0.3);
            transition: all 0.3s ease;
        }

        .section-card:hover .section-icon {
            transform: rotate(5deg) scale(1.1);
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 0.75rem 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            transition: all 0.2s ease;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .feature-list li:hover {
            padding-left: 10px;
            color: var(--primary-color);
        }

        .feature-list li i {
            color: var(--secondary-color);
            margin-right: 1rem;
            font-size: 1.2rem;
        }

        .step-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-left: 4px solid var(--primary-color);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .step-card:hover {
            border-left-width: 6px;
            box-shadow: 0 5px 15px rgba(11, 137, 27, 0.1);
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 1rem;
        }

        .badge-modern {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 25px;
            font-size: 0.875rem;
            font-weight: 600;
            margin: 0.25rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .table-modern {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }

        .table-modern thead {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .table-modern tbody tr {
            transition: all 0.2s ease;
        }

        .table-modern tbody tr:hover {
            background-color: rgba(11, 137, 27, 0.05);
            transform: scale(1.01);
        }

        .btn-manual {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(11, 137, 27, 0.3);
        }

        .btn-manual:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(11, 137, 27, 0.4);
            color: white;
        }

        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(11, 137, 27, 0.2);
            z-index: 9999;
        }

        .scroll-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.1s ease;
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 2rem 1rem;
            }
            
            .section-card {
                padding: 1.5rem;
            }
        }

        .highlight-box {
            background: linear-gradient(135deg, rgba(11, 137, 27, 0.1), rgba(40, 167, 69, 0.1));
            border-left: 4px solid var(--primary-color);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .grid-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .feature-box {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .feature-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(11, 137, 27, 0.2);
        }

        .feature-box i {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        /* Bot√≥n Subir Arriba */
        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 5px 20px rgba(11, 137, 27, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
        }

        .scroll-to-top.show {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .scroll-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(11, 137, 27, 0.6);
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
        }

        .scroll-to-top:active {
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .scroll-to-top {
                bottom: 20px;
                right: 20px;
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
        }

        /* Switch de Idioma - Estilos base */
        .language-switch-container {
            position: absolute !important;
            top: 20px !important;
            right: 20px !important;
            z-index: 1000 !important;
            background: white !important;
            padding: 0.75rem 1.25rem !important;
            border-radius: 20px !important;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4) !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
            border: 3px solid var(--primary-color) !important;
            min-width: 140px !important;
            justify-content: center !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .language-switch {
            position: relative;
            display: inline-block;
            width: 80px;
            height: 40px;
        }

        .language-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .language-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 40px;
        }

        .language-slider:before {
            position: absolute;
            content: "";
            height: 32px;
            width: 32px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .language-switch input:checked + .language-slider {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .language-switch input:checked + .language-slider {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
        }

        .language-switch input:checked + .language-slider span {
            transform: translateX(30px) !important;
        }

        #languageToggle:checked + #languageSlider {
            background: linear-gradient(135deg, #0b891b, #28a745) !important;
        }

        #languageToggle:checked + #languageSlider #sliderButton {
            transform: translateX(30px) !important;
        }

        /* Asegurar que el switch sea visible en todos los casos */
        #languageSwitchContainer {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .language-label {
            font-weight: 700;
            font-size: 1rem;
            color: var(--dark-color);
            white-space: nowrap;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .language-label.active {
            color: var(--primary-color);
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(11, 137, 27, 0.2);
        }

        .language-switch-container:hover {
            box-shadow: 0 10px 35px rgba(11, 137, 27, 0.5);
            transform: translateY(-3px);
            transition: all 0.3s ease;
        }

        /* Removido el ::before que puede causar problemas */

        /* Badges de Permisos */
        .role-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .role-badge.admin {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }

        .role-badge.comercial {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
        }

        .role-badge.all {
            background: linear-gradient(135deg, #28a745, #218838);
            color: white;
        }

        @media (max-width: 768px) {
            #languageSwitchContainer {
                top: 15px !important;
                left: 15px !important;
                padding: 8px 10px !important;
                gap: 10px !important;
            }

            .flag-image {
                width: 35px !important;
                height: 24px !important;
            }
        }
    </style>
</head>
<body>
    <%- include('../partials/navbar-dashboard') %>
    
    <div class="scroll-indicator">
        <div class="scroll-progress" id="scrollProgress"></div>
    </div>

    <!-- Selector de Idioma con Banderas - FUERA del contenedor para m√°xima visibilidad -->
    <div id="languageSwitchContainer">
        <img src="/images/bandera-es.jpg" alt="Espa√±ol" class="flag-image active" id="flagSpain" title="Espa√±ol" data-lang="es">
        <img src="/images/bandera-it.jpg" alt="Italiano" class="flag-image" id="flagItaly" title="Italiano" data-lang="it">
    </div>

    <div class="container manual-container">
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="hero-content text-center">
                <img src="/images/logo.png" alt="Farmadescanso" class="hero-logo">
                <h1 class="display-4 fw-bold mb-3" data-lang="es">Manual de Instrucciones</h1>
                <h1 class="display-4 fw-bold mb-3" data-lang="it" style="display: none;">Manuale di Istruzioni</h1>
                <p class="lead mb-4" data-lang="es">Gu√≠a completa para el uso del CRM Farmadescanso</p>
                <p class="lead mb-4" data-lang="it" style="display: none;">Guida completa per l'uso del CRM Farmadescanso</p>
                <p class="mb-0" data-lang="es">Aprende a utilizar todas las funcionalidades de la aplicaci√≥n de forma eficiente</p>
                <p class="mb-0" data-lang="it" style="display: none;">Impara a utilizzare tutte le funzionalit√† dell'applicazione in modo efficiente</p>
            </div>
        </div>

        <!-- √çndice de Contenidos -->
        <div class="section-card">
            <h2 class="fw-bold mb-4">
                <i class="fas fa-list-ul text-primary me-2"></i>
                <span data-lang="es">√çndice de Contenidos</span>
                <span data-lang="it" style="display: none;">Indice dei Contenuti</span>
            </h2>
            <div class="row">
                <div class="col-md-6">
                    <ul class="feature-list">
                        <li><i class="fas fa-chevron-right"></i><a href="#dashboard" class="text-decoration-none text-dark"><span data-lang="es">Dashboard Principal</span><span data-lang="it" style="display: none;">Dashboard Principale</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#pedidos" class="text-decoration-none text-dark"><span data-lang="es">Gesti√≥n de Pedidos</span><span data-lang="it" style="display: none;">Gestione Ordini</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#clientes" class="text-decoration-none text-dark"><span data-lang="es">Gesti√≥n de Clientes</span><span data-lang="it" style="display: none;">Gestione Clienti</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#visitas" class="text-decoration-none text-dark"><span data-lang="es">Programaci√≥n de Visitas</span><span data-lang="it" style="display: none;">Pianificazione Visite</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#articulos" class="text-decoration-none text-dark"><span data-lang="es">Cat√°logo de Art√≠culos</span><span data-lang="it" style="display: none;">Catalogo Articoli</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#comisiones" class="text-decoration-none text-dark"><span data-lang="es">Comisiones</span><span data-lang="it" style="display: none;">Commissioni</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#manual" class="text-decoration-none text-dark"><span data-lang="es">Manual de Instrucciones</span><span data-lang="it" style="display: none;">Manuale di Istruzioni</span></a></li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="feature-list">
                        <li><i class="fas fa-chevron-right"></i><a href="#cooperativas" class="text-decoration-none text-dark"><span data-lang="es">Cooperativas</span><span data-lang="it" style="display: none;">Cooperative</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#comerciales" class="text-decoration-none text-dark"><span data-lang="es">Comerciales</span><span data-lang="it" style="display: none;">Commerciali</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#reportes" class="text-decoration-none text-dark"><span data-lang="es">Reportes y Estad√≠sticas</span><span data-lang="it" style="display: none;">Report e Statistiche</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#configuracion" class="text-decoration-none text-dark"><span data-lang="es">Configuraci√≥n</span><span data-lang="it" style="display: none;">Configurazione</span></a></li>
                        <li><i class="fas fa-chevron-right"></i><a href="#consejos" class="text-decoration-none text-dark"><span data-lang="es">Consejos y Mejores Pr√°cticas</span><span data-lang="it" style="display: none;">Consigli e Best Practice</span></a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Dashboard Principal -->
        <div id="dashboard" class="section-card">
            <div class="section-icon">
                <i class="fas fa-tachometer-alt"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Dashboard Principal</span>
                <span data-lang="it" style="display: none;">Dashboard Principale</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">El Dashboard es tu punto de partida. Aqu√≠ puedes ver un resumen general de todas tus actividades y estad√≠sticas importantes.</span>
                <span data-lang="it" style="display: none;">La Dashboard √® il tuo punto di partenza. Qui puoi vedere un riepilogo generale di tutte le tue attivit√† e statistiche importanti.</span>
            </p>
            
            <div class="highlight-box">
                <h5 class="fw-bold mb-3"><i class="fas fa-info-circle me-2"></i>¬øQu√© encontrar√°s en el Dashboard?</h5>
                <ul class="feature-list">
                    <li><i class="fas fa-check-circle"></i><strong>Total de Ventas:</strong> Visualiza el importe total de todas tus ventas</li>
                    <li><i class="fas fa-check-circle"></i><strong>Ventas del Mes:</strong> Importe y cantidad de pedidos del mes actual</li>
                    <li><i class="fas fa-check-circle"></i><strong>Estad√≠sticas en Tiempo Real:</strong> M√©tricas actualizadas autom√°ticamente</li>
                    <li><i class="fas fa-check-circle"></i><strong>Accesos R√°pidos:</strong> Enlaces directos a las secciones m√°s utilizadas</li>
                </ul>
            </div>

            <h5 class="fw-bold mt-4 mb-3">Funcionalidades del Dashboard:</h5>
            <div class="step-card">
                <span class="step-number">1</span>
                <strong>Visualizaci√≥n de Estad√≠sticas</strong>
                <p class="mt-2 mb-0">Las tarjetas superiores muestran m√©tricas clave: Total de Ventas, Importe del Mes, Pedidos del Mes, y m√°s seg√∫n tu rol. Estas estad√≠sticas se actualizan autom√°ticamente en tiempo real.</p>
            </div>
            <div class="step-card">
                <span class="step-number">2</span>
                <strong>Filtros por A√±o</strong>
                <p class="mt-2 mb-0">Utiliza el dropdown superior derecho para filtrar las estad√≠sticas por a√±o espec√≠fico (√∫ltimos 10 a√±os disponibles) o ver "Todos" los a√±os. Esto te permite analizar tendencias hist√≥ricas y comparar per√≠odos.</p>
            </div>
            <div class="step-card">
                <span class="step-number">3</span>
                <strong>Actualizaci√≥n Manual</strong>
                <p class="mt-2 mb-0">Utiliza el bot√≥n "Actualizar" para refrescar manualmente los datos del dashboard sin recargar toda la p√°gina.</p>
            </div>
            <div class="step-card">
                <span class="step-number">4</span>
                <strong>Navegaci√≥n R√°pida</strong>
                <p class="mt-2 mb-0">Desde el Dashboard puedes acceder r√°pidamente a crear nuevos pedidos, ver clientes, gestionar visitas, y todas las secciones principales del CRM.</p>
            </div>
            <div class="step-card">
                <span class="step-number">5</span>
                <strong>Acceso al Manual</strong>
                <p class="mt-2 mb-0">Desde tu perfil (men√∫ usuario) puedes acceder al "Manual de Instrucciones" para consultar esta gu√≠a completa en cualquier momento.</p>
            </div>
        </div>

        <!-- Gesti√≥n de Pedidos -->
        <div id="pedidos" class="section-card">
            <div class="section-icon">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Gesti√≥n de Pedidos</span>
                <span data-lang="it" style="display: none;">Gestione Ordini</span>
                <span class="role-badge comercial" data-lang="es">Comerciales</span>
                <span class="role-badge comercial" data-lang="it" style="display: none;">Commerciali</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Los pedidos son el coraz√≥n de tu actividad comercial. Aprende a crear, gestionar y hacer seguimiento de todos tus pedidos.</span>
                <span data-lang="it" style="display: none;">Gli ordini sono il cuore della tua attivit√† commerciale. Impara a creare, gestire e monitorare tutti i tuoi ordini.</span>
            </p>

            <h5 class="fw-bold mt-4 mb-3">Crear un Nuevo Pedido:</h5>
            <div class="step-card">
                <span class="step-number">1</span>
                <strong>Acceder al Formulario</strong>
                <p class="mt-2 mb-0">Haz clic en el bot√≥n "Nuevo Pedido" desde el Dashboard o desde la secci√≥n de Pedidos.</p>
            </div>
            <div class="step-card">
                <span class="step-number">2</span>
                <strong>Seleccionar Cliente</strong>
                <p class="mt-2 mb-0">Busca y selecciona el cliente. Puedes buscar por nombre, DNI/CIF, email o tel√©fono. El sistema te mostrar√° sugerencias mientras escribes.</p>
            </div>
            <div class="step-card">
                <span class="step-number">3</span>
                <strong>Agregar Art√≠culos</strong>
                <p class="mt-2 mb-0">Busca art√≠culos por nombre o SKU. Agrega la cantidad, precio unitario, IVA y descuento (si aplica). Puedes agregar m√∫ltiples l√≠neas.</p>
            </div>
            <div class="step-card">
                <span class="step-number">4</span>
                <strong>Configurar Detalles</strong>
                <p class="mt-2 mb-0">Completa la informaci√≥n: Fecha del pedido, Fecha de entrega, Tipo de pedido, Forma de pago, y estado (Pendiente, Confirmado, Enviado, Entregado, Cancelado).</p>
            </div>
            <div class="step-card">
                <span class="step-number">5</span>
                <strong>Informaci√≥n de Cooperativa (opcional)</strong>
                <p class="mt-2 mb-0">Si el cliente pertenece a una cooperativa, puedes agregar el n√∫mero de pedido de la cooperativa y su nombre.</p>
            </div>
            <div class="step-card">
                <span class="step-number">6</span>
                <strong>Guardar el Pedido</strong>
                <p class="mt-2 mb-0">Revisa toda la informaci√≥n y haz clic en "Crear Pedido". El sistema calcular√° autom√°ticamente los totales, IVA y el importe final.</p>
            </div>

            <div class="highlight-box mt-4">
                <h5 class="fw-bold mb-3"><i class="fas fa-lightbulb me-2"></i>Consejos para Pedidos:</h5>
                <ul class="feature-list">
                    <li><i class="fas fa-star"></i>Utiliza el buscador de art√≠culos para encontrar productos r√°pidamente</li>
                    <li><i class="fas fa-star"></i>Verifica siempre los precios y cantidades antes de guardar</li>
                    <li><i class="fas fa-star"></i>Los descuentos se aplican por l√≠nea de pedido</li>
                    <li><i class="fas fa-star"></i>Puedes agregar observaciones para informaci√≥n adicional</li>
                </ul>
            </div>

            <h5 class="fw-bold mt-4 mb-3">Gestionar Pedidos Existentes:</h5>
            <p>Desde la secci√≥n de Pedidos puedes:</p>
            <ul class="feature-list">
                <li><i class="fas fa-eye"></i><strong>Ver Detalles:</strong> Haz clic en cualquier pedido para ver toda su informaci√≥n</li>
                <li><i class="fas fa-edit"></i><strong>Editar Pedidos:</strong> Modifica pedidos pendientes o confirmados</li>
                <li><i class="fas fa-filter"></i><strong>Filtrar y Buscar:</strong> Utiliza los filtros para encontrar pedidos por cliente, fecha, estado, etc.</li>
                <li><i class="fas fa-file-export"></i><strong>Exportar Informes:</strong> Genera informes de pedidos para an√°lisis</li>
            </ul>
        </div>

        <!-- Gesti√≥n de Clientes -->
        <div id="clientes" class="section-card">
            <div class="section-icon">
                <i class="fas fa-users"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Gesti√≥n de Clientes</span>
                <span data-lang="it" style="display: none;">Gestione Clienti</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Gestiona tu base de datos de clientes de forma eficiente. Mant√©n toda la informaci√≥n actualizada para un mejor seguimiento comercial.</span>
                <span data-lang="it" style="display: none;">Gestisci il tuo database clienti in modo efficiente. Mantieni tutte le informazioni aggiornate per un migliore monitoraggio commerciale.</span>
            </p>
            
            <div class="highlight-box">
                <h5 class="fw-bold mb-3"><i class="fas fa-info-circle me-2"></i>Filtros Avanzados:</h5>
                <p>La secci√≥n de clientes incluye filtros avanzados para:</p>
                <ul class="feature-list">
                    <li><i class="fas fa-filter"></i>Buscar por nombre, DNI/CIF, email, tel√©fono o direcci√≥n</li>
                    <li><i class="fas fa-user-tie"></i>Filtrar por comercial asignado</li>
                    <li><i class="fas fa-map-marker-alt"></i>Filtrar por c√≥digo postal o poblaci√≥n</li>
                    <li><i class="fas fa-shopping-cart"></i>Filtrar clientes con o sin pedidos</li>
                </ul>
            </div>

            <div class="grid-features">
                <div class="feature-box">
                    <i class="fas fa-user-plus"></i>
                    <h5>Agregar Clientes</h5>
                    <p>Registra nuevos clientes con toda su informaci√≥n de contacto</p>
                </div>
                <div class="feature-box">
                    <i class="fas fa-search"></i>
                    <h5>Buscar Clientes</h5>
                    <p>B√∫squeda r√°pida por nombre, DNI/CIF, email o tel√©fono</p>
                </div>
                <div class="feature-box">
                    <i class="fas fa-edit"></i>
                    <h5>Editar Informaci√≥n</h5>
                    <p>Actualiza datos de clientes existentes en cualquier momento</p>
                </div>
                <div class="feature-box">
                    <i class="fas fa-link"></i>
                    <h5>Vinculaci√≥n</h5>
                    <p>Asocia clientes con cooperativas y comerciales</p>
                </div>
            </div>

            <h5 class="fw-bold mt-4 mb-3">Informaci√≥n del Cliente:</h5>
            <div class="table-modern table-responsive mt-3">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Campo</th>
                            <th>Descripci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Nombre/Raz√≥n Social</strong></td>
                            <td>Nombre completo del cliente o raz√≥n social si es empresa</td>
                        </tr>
                        <tr>
                            <td><strong>DNI/CIF</strong></td>
                            <td>Documento de identificaci√≥n fiscal</td>
                        </tr>
                        <tr>
                            <td><strong>Contacto</strong></td>
                            <td>Email, tel√©fono fijo y m√≥vil</td>
                        </tr>
                        <tr>
                            <td><strong>Direcci√≥n</strong></td>
                            <td>Direcci√≥n completa, c√≥digo postal y poblaci√≥n</td>
                        </tr>
                        <tr>
                            <td><strong>Comercial Asignado</strong></td>
                            <td>Comercial responsable del cliente. Los administradores pueden gestionar asignaciones desde "Ajustes ‚Üí Asignaciones Comerciales"</td>
                        </tr>
                        <tr>
                            <td><strong>Cooperativa</strong></td>
                            <td>Cooperativa a la que pertenece (si aplica). Puede vincularse desde la secci√≥n "Clientes-Cooperativas"</td>
                        </tr>
                        <tr>
                            <td><strong>C√≥digo Postal</strong></td>
                            <td>El sistema puede asignar autom√°ticamente la provincia bas√°ndose en el c√≥digo postal (configurado por administradores)</td>
                        </tr>
                        <tr>
                            <td><strong>Especialidad</strong></td>
                            <td>Especialidad m√©dica del cliente (si aplica)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="step-card mt-4">
                <span class="step-number">üìã</span>
                <strong>Gesti√≥n de Asignaciones (Solo Administradores)</strong>
                <p class="mt-2 mb-0">Los administradores pueden asignar comerciales a clientes de forma individual o masiva desde "Ajustes ‚Üí Asignaciones Comerciales". Esta herramienta permite asignar m√∫ltiples clientes a un comercial bas√°ndose en criterios como c√≥digo postal, poblaci√≥n o selecci√≥n manual.</p>
            </div>
        </div>

        <!-- Programaci√≥n de Visitas -->
        <div id="visitas" class="section-card">
            <div class="section-icon">
                <i class="fas fa-calendar-check"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Programaci√≥n de Visitas</span>
                <span data-lang="it" style="display: none;">Pianificazione Visite</span>
                <span class="role-badge comercial" data-lang="es">Comerciales</span>
                <span class="role-badge comercial" data-lang="it" style="display: none;">Commerciali</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Organiza y gestiona tus visitas a clientes. Mant√©n un calendario actualizado y nunca pierdas una cita.</span>
                <span data-lang="it" style="display: none;">Organizza e gestisci le tue visite ai clienti. Mantieni un calendario aggiornato e non perdere mai un appuntamento.</span>
            </p>

            <div class="step-card">
                <span class="step-number">1</span>
                <strong>Crear una Nueva Visita</strong>
                <p class="mt-2 mb-0">Accede a la secci√≥n de Visitas y haz clic en "Nueva Visita". Selecciona el cliente, fecha, hora y duraci√≥n estimada.</p>
            </div>
            <div class="step-card">
                <span class="step-number">2</span>
                <strong>Enlaces de reuni√≥n (manual)</strong>
                <p class="mt-2 mb-0">La integraci√≥n autom√°tica de reuniones (Meet/Teams) est√° desactivada. Si necesitas una reuni√≥n, crea el enlace manualmente en tu herramienta habitual.</p>
            </div>
            <div class="step-card">
                <span class="step-number">3</span>
                <strong>Gesti√≥n del Calendario</strong>
                <p class="mt-2 mb-0">Visualiza todas tus visitas en el calendario mensual. Puedes filtrar por comercial, cliente o rango de fechas.</p>
            </div>
            <div class="step-card">
                <span class="step-number">4</span>
                <strong>Actualizar Estado</strong>
                <p class="mt-2 mb-0">Marca las visitas como completadas, canceladas o reagendadas. Agrega notas y resultados de la visita.</p>
            </div>

            <div class="highlight-box mt-4">
                <h5 class="fw-bold mb-3"><i class="fas fa-calendar-alt me-2"></i>Integraci√≥n con Google Calendar:</h5>
                <p>Actualmente la creaci√≥n autom√°tica de enlaces de reuni√≥n est√° desactivada. El sistema permite gestionar la visita, y puedes a√±adir el enlace manualmente si lo necesitas.</p>
            </div>
        </div>

        <!-- Cat√°logo de Art√≠culos -->
        <div id="articulos" class="section-card">
            <div class="section-icon">
                <i class="fas fa-boxes"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Cat√°logo de Art√≠culos</span>
                <span data-lang="it" style="display: none;">Catalogo Articoli</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Explora el cat√°logo completo de productos disponibles. Conoce precios, SKUs y disponibilidad.</span>
                <span data-lang="it" style="display: none;">Esplora il catalogo completo dei prodotti disponibili. Conosci prezzi, SKU e disponibilit√†.</span>
            </p>

            <h5 class="fw-bold mb-3">Informaci√≥n de los Art√≠culos:</h5>
            <ul class="feature-list">
                <li><i class="fas fa-barcode"></i><strong>SKU:</strong> C√≥digo √∫nico de identificaci√≥n del producto</li>
                <li><i class="fas fa-tag"></i><strong>Nombre:</strong> Descripci√≥n completa del art√≠culo</li>
                <li><i class="fas fa-euro-sign"></i><strong>PVL (Precio de Venta al Laboratorio):</strong> Precio de venta est√°ndar recomendado</li>
                <li><i class="fas fa-percent"></i><strong>PCP (Precio de Coste al Proveedor):</strong> Precio de compra al proveedor. Gestionado por administradores en "Ajustes ‚Üí Gesti√≥n PCP"</li>
                <li><i class="fas fa-chart-line"></i><strong>Margen y Rentabilidad:</strong> Diferencia entre PVL y PCP, expresada en euros y porcentaje. Se calcula autom√°ticamente cuando ambos valores est√°n disponibles</li>
                <li><i class="fas fa-tags"></i><strong>Marca:</strong> Marca del producto para filtrado y an√°lisis</li>
            </ul>

            <div class="highlight-box mt-4">
                <h5 class="fw-bold mb-3"><i class="fas fa-info-circle me-2"></i>Uso del Cat√°logo:</h5>
                <p>Al crear un pedido, utiliza el buscador de art√≠culos para encontrar productos. El sistema mostrar√° autom√°ticamente el precio recomendado (PVL), pero puedes ajustarlo seg√∫n las condiciones comerciales espec√≠ficas.</p>
                <p class="mb-0 mt-2"><strong>Nota para Administradores:</strong> Los Precios de Coste al Proveedor (PCP) se gestionan desde "Ajustes ‚Üí Gesti√≥n PCP". Estos valores son necesarios para calcular la rentabilidad real de los pedidos y art√≠culos.</p>
            </div>

            <h5 class="fw-bold mt-4 mb-3">Art√≠culos Principales:</h5>
            <p class="mb-3">El cat√°logo incluye productos de diferentes categor√≠as:</p>
            <div class="row">
                <div class="col-md-6">
                    <span class="badge-modern">Cuidado Personal</span>
                    <span class="badge-modern">Higiene √çntima</span>
                    <span class="badge-modern">Cuidado Bucal</span>
                    <span class="badge-modern">Hidrataci√≥n</span>
                </div>
                <div class="col-md-6">
                    <span class="badge-modern">Packs Especiales</span>
                    <span class="badge-modern">L√≠nea Atopic</span>
                    <span class="badge-modern">Productos Gemavip</span>
                </div>
            </div>
        </div>

        <!-- Comisiones -->
        <div id="comisiones" class="section-card">
            <div class="section-icon">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Sistema de Comisiones</span>
                <span data-lang="it" style="display: none;">Sistema di Commissioni</span>
                <span class="role-badge comercial" data-lang="es">Comerciales</span>
                <span class="role-badge comercial" data-lang="it" style="display: none;">Commerciali</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Consulta tus comisiones calculadas autom√°ticamente seg√∫n las ventas y objetivos establecidos.</span>
                <span data-lang="it" style="display: none;">Consulta le tue commissioni calcolate automaticamente in base alle vendite e agli obiettivi stabiliti.</span>
            </p>

            <div class="step-card">
                <span class="step-number">1</span>
                <strong>Acceder a Mis Comisiones</strong>
                <p class="mt-2 mb-0">Desde el men√∫ lateral del Dashboard, selecciona "Mis Comisiones" para ver el resumen completo de tus ganancias del per√≠odo seleccionado.</p>
            </div>
            <div class="step-card">
                <span class="step-number">2</span>
                <strong>Filtros de B√∫squeda</strong>
                <p class="mt-2 mb-0">Utiliza los filtros para seleccionar el mes y a√±o espec√≠fico que deseas consultar. Puedes revisar comisiones hist√≥ricas y comparar per√≠odos.</p>
            </div>
            <div class="step-card">
                <span class="step-number">3</span>
                <strong>Desglose Detallado</strong>
                <p class="mt-2 mb-0">Visualiza el desglose completo: fijo mensual, comisiones por ventas, rappels por objetivos, rappel por presupuesto, y cualquier condici√≥n especial aplicable.</p>
            </div>
            <div class="step-card">
                <span class="step-number">4</span>
                <strong>C√°lculo Autom√°tico</strong>
                <p class="mt-2 mb-0">Las comisiones se calculan autom√°ticamente bas√°ndose en los pedidos registrados. El sistema tiene en cuenta el tipo de pedido, los objetivos alcanzados y las condiciones especiales configuradas.</p>
            </div>

            <div class="highlight-box mt-4">
                <h5 class="fw-bold mb-3"><i class="fas fa-calculator me-2"></i>Tipos de Comisiones:</h5>
                <ul class="feature-list">
                    <li><i class="fas fa-coins"></i><strong>Fijo Mensual:</strong> Salario base mensual configurado para el per√≠odo</li>
                    <li><i class="fas fa-percent"></i><strong>Comisi√≥n por Ventas:</strong> Porcentaje aplicable sobre el total de ventas seg√∫n el tipo de pedido</li>
                    <li><i class="fas fa-trophy"></i><strong>Rappels por Objetivos:</strong> Bonificaciones adicionales por alcanzar objetivos de marca o volumen</li>
                    <li><i class="fas fa-chart-line"></i><strong>Rappel por Presupuesto:</strong> Bonificaciones por cumplir o superar los presupuestos establecidos</li>
                    <li><i class="fas fa-star"></i><strong>Condiciones Especiales:</strong> Comisiones adicionales configuradas para situaciones espec√≠ficas</li>
                </ul>
                <p class="mb-0 mt-3"><strong>Nota:</strong> La configuraci√≥n de comisiones y objetivos es gestionada por los administradores del sistema.</p>
            </div>
        </div>

        <!-- Cooperativas -->
        <div id="cooperativas" class="section-card">
            <div class="section-icon">
                <i class="fas fa-handshake"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Gesti√≥n de Cooperativas</span>
                <span data-lang="it" style="display: none;">Gestione Cooperative</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Administra las cooperativas farmac√©uticas y sus relaciones con clientes.</span>
                <span data-lang="it" style="display: none;">Gestisci le cooperative farmaceutiche e le loro relazioni con i clienti.</span>
            </p>

            <ul class="feature-list">
                <li><i class="fas fa-building"></i><strong>Registrar Cooperativas:</strong> Agrega nuevas cooperativas al sistema con toda su informaci√≥n</li>
                <li><i class="fas fa-link"></i><strong>Vincular Clientes:</strong> Asocia clientes a cooperativas espec√≠ficas</li>
                <li><i class="fas fa-id-card"></i><strong>N√∫mero de Asociado:</strong> Gestiona el n√∫mero de asociado de cada cliente en su cooperativa</li>
                <li><i class="fas fa-list"></i><strong>Listar Relaciones:</strong> Visualiza todos los clientes vinculados a cada cooperativa</li>
            </ul>

            <div class="highlight-box mt-4">
                <p><strong>Nota:</strong> Al crear un pedido para un cliente asociado a una cooperativa, puedes indicar el n√∫mero de pedido de la cooperativa para mejor seguimiento.</p>
            </div>
        </div>

        <!-- Comerciales -->
        <div id="comerciales" class="section-card">
            <div class="section-icon">
                <i class="fas fa-user-tie"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Gesti√≥n de Comerciales</span>
                <span data-lang="it" style="display: none;">Gestione Commerciali</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Visualiza y gestiona la informaci√≥n de todos los comerciales del equipo.</span>
                <span data-lang="it" style="display: none;">Visualizza e gestisci le informazioni di tutti i commerciali del team.</span>
            </p>

            <ul class="feature-list">
                <li><i class="fas fa-user-circle"></i><strong>Ver Perfil:</strong> Consulta la informaci√≥n de contacto y datos de cada comercial</li>
                <li><i class="fas fa-edit"></i><strong>Editar Perfil:</strong> Actualiza tu informaci√≥n personal y de contacto</li>
                <li><i class="fas fa-cog"></i><strong>Configuraci√≥n:</strong> Configura integraciones como Google OAuth para Meet y Teams</li>
                <li><i class="fas fa-users"></i><strong>Asignaciones:</strong> (Solo administradores) Asigna comerciales a clientes y zonas</li>
            </ul>
        </div>

        <!-- Reportes y Estad√≠sticas -->
        <div id="reportes" class="section-card">
            <div class="section-icon">
                <i class="fas fa-chart-bar"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Reportes y Estad√≠sticas</span>
                <span data-lang="it" style="display: none;">Report e Statistiche</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Analiza tu rendimiento con reportes detallados y estad√≠sticas visuales.</span>
                <span data-lang="it" style="display: none;">Analizza le tue prestazioni con report dettagliati e statistiche visive.</span>
            </p>

            <div class="grid-features">
                <div class="feature-box">
                    <i class="fas fa-file-alt"></i>
                    <h5>Informes de Pedidos</h5>
                    <p>Genera informes detallados de todos tus pedidos</p>
                </div>
                <div class="feature-box">
                    <i class="fas fa-chart-pie"></i>
                    <h5>Estad√≠sticas de Ventas</h5>
                    <p>Visualiza gr√°ficos de ventas por mes y per√≠odo</p>
                </div>
                <div class="feature-box">
                    <i class="fas fa-chart-line"></i>
                    <h5>Presupuestos vs Ventas</h5>
                    <p>Compara tus ventas con los presupuestos establecidos</p>
                </div>
                <div class="feature-box">
                    <i class="fas fa-percent"></i>
                    <h5>Rentabilidad</h5>
                    <p>Analiza la rentabilidad por art√≠culo y por pedido (solo administradores)</p>
                </div>
            </div>

            <h5 class="fw-bold mt-4 mb-3">Presupuestos vs Ventas:</h5>
            <div class="highlight-box mt-3">
                <p>La secci√≥n <strong>Presupuestos vs Ventas</strong> te permite:</p>
                <ul class="feature-list">
                    <li><i class="fas fa-check"></i>Comparar tus ventas reales con los presupuestos asignados</li>
                    <li><i class="fas fa-check"></i>Visualizar el porcentaje de cumplimiento de objetivos</li>
                    <li><i class="fas fa-check"></i>Analizar tendencias y desviaciones mes a mes</li>
                    <li><i class="fas fa-check"></i>Identificar oportunidades de mejora</li>
                </ul>
                <p class="mb-0 mt-3"><strong>Acceso:</strong> Desde el men√∫ lateral del Dashboard, selecciona "Presupuestos vs Ventas".</p>
            </div>

            <h5 class="fw-bold mt-4 mb-3">
                <span data-lang="es">An√°lisis de Rentabilidad (Solo Administradores):</span>
                <span data-lang="it" style="display: none;">Analisi della Redditivit√† (Solo Amministratori):</span>
            </h5>
            <div class="step-card">
                <span class="step-number">üìä</span>
                <strong>
                    <span data-lang="es">Rentabilidad por Pedido</span>
                    <span data-lang="it" style="display: none;">Redditivit√† per Ordine</span>
                </strong>
                <p class="mt-2 mb-0">
                    <span data-lang="es">Analiza la rentabilidad de cada pedido individual, incluyendo margen, porcentaje de rentabilidad, y comparaci√≥n con PCP (Precio de Coste al Proveedor). Puedes filtrar por comercial, marca, tipo de pedido y rango de fechas. Esta herramienta es esencial para identificar qu√© pedidos generan mayor rentabilidad.</span>
                    <span data-lang="it" style="display: none;">Analizza la redditivit√† di ogni singolo ordine, inclusi margine, percentuale di redditivit√† e confronto con PCP (Prezzo di Costo al Fornitore). Puoi filtrare per commerciale, marca, tipo di ordine e intervallo di date. Questo strumento √® essenziale per identificare quali ordini generano maggiore redditivit√†.</span>
                </p>
            </div>
            <div class="step-card">
                <span class="step-number">üìà</span>
                <strong>
                    <span data-lang="es">Rentabilidad por Art√≠culo</span>
                    <span data-lang="it" style="display: none;">Redditivit√† per Articolo</span>
                </strong>
                <p class="mt-2 mb-0">
                    <span data-lang="es">Visualiza la rentabilidad de cada art√≠culo del cat√°logo, incluyendo margen promedio, rentabilidad porcentual, y estad√≠sticas de ventas por producto. √ötil para identificar los productos m√°s rentables y optimizar el cat√°logo.</span>
                    <span data-lang="it" style="display: none;">Visualizza la redditivit√† di ogni articolo del catalogo, incluso margine medio, redditivit√† percentuale e statistiche di vendita per prodotto. Utile per identificare i prodotti pi√π redditizi e ottimizzare il catalogo.</span>
                </p>
            </div>
            <div class="highlight-box mt-3">
                <p>
                    <strong data-lang="es">Acceso:</strong>
                    <strong data-lang="it" style="display: none;">Accesso:</strong>
                    <span data-lang="es"> Men√∫ Usuario ‚Üí Rentabilidad ‚Üí "Rentabilidad por Pedido" o "Rentabilidad Art√≠culos" (solo administradores).</span>
                    <span data-lang="it" style="display: none;"> Menu Utente ‚Üí Redditivit√† ‚Üí "Redditivit√† per Ordine" o "Redditivit√† Articoli" (solo amministratori).</span>
                </p>
                <p class="mb-0">
                    <strong data-lang="es">Requisito:</strong>
                    <strong data-lang="it" style="display: none;">Requisito:</strong>
                    <span data-lang="es"> Para que los an√°lisis de rentabilidad sean precisos, es necesario que los art√≠culos tengan configurado su PCP (Precio de Coste al Proveedor) desde "Ajustes ‚Üí Gesti√≥n PCP".</span>
                    <span data-lang="it" style="display: none;"> Affinch√© le analisi di redditivit√† siano precise, √® necessario che gli articoli abbiano configurato il loro PCP (Prezzo di Costo al Fornitore) da "Impostazioni ‚Üí Gestione PCP".</span>
                </p>
            </div>
        </div>

        <!-- Configuraci√≥n -->
        <div id="configuracion" class="section-card">
            <div class="section-icon">
                <i class="fas fa-cog"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Configuraci√≥n y Ajustes</span>
                <span data-lang="it" style="display: none;">Configurazione e Impostazioni</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Personaliza la aplicaci√≥n seg√∫n tus necesidades y configura integraciones.</span>
                <span data-lang="it" style="display: none;">Personalizza l'applicazione secondo le tue esigenze e configura le integrazioni.</span>
            </p>

            <h5 class="fw-bold mb-3">
                <span data-lang="es">Configuraciones Disponibles para Todos:</span>
                <span data-lang="it" style="display: none;">Configurazioni Disponibili per Tutti:</span>
            </h5>
            <div class="table-modern table-responsive mt-3">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Secci√≥n</th>
                            <th>Descripci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Formas de Pago</strong></td>
                            <td>Gestiona los m√©todos de pago disponibles para los pedidos (transferencia, efectivo, tarjeta, etc.)</td>
                        </tr>
                        <tr>
                            <td><strong>Especialidades</strong></td>
                            <td>Administra las especialidades m√©dicas asociadas a clientes (cardiolog√≠a, dermatolog√≠a, etc.)</td>
                        </tr>
                        <tr>
                            <td><strong>Mi Perfil</strong></td>
                            <td>Actualiza tu informaci√≥n personal, contacto y configura integraciones como Google OAuth para Meet</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h5 class="fw-bold mt-4 mb-3">
                <span data-lang="es">Configuraciones Administrativas (Solo Administradores):</span>
                <span data-lang="it" style="display: none;">Configurazioni Amministrative (Solo Amministratori):</span>
                <span class="role-badge admin" data-lang="es">Solo Admin</span>
                <span class="role-badge admin" data-lang="it" style="display: none;">Solo Admin</span>
            </h5>
            <div class="highlight-box">
                <p class="mb-3">
                    <span data-lang="es">Los administradores tienen acceso a configuraciones avanzadas organizadas en submen√∫s:</span>
                    <span data-lang="it" style="display: none;">Gli amministratori hanno accesso a configurazioni avanzate organizzate in sottomenu:</span>
                </p>
                
                <h6 class="fw-bold mt-3 mb-2"><i class="fas fa-plug me-2"></i>Integraciones:</h6>
                <ul class="feature-list">
                    <li><i class="fas fa-link"></i><strong>Webhook N8N:</strong> Configura webhooks para automatizaci√≥n de procesos</li>
                    <li><i class="fas fa-shopping-bag"></i><strong>Prestashop:</strong> Integraci√≥n con la tienda online Prestashop</li>
                    <!-- Integraci√≥n Meet/Teams desactivada -->
                </ul>

                <h6 class="fw-bold mt-3 mb-2"><i class="fas fa-code me-2"></i>API y Documentaci√≥n:</h6>
                <ul class="feature-list">
                    <li><i class="fas fa-key"></i><strong>API Keys:</strong> Gestiona las claves de API para integraciones externas</li>
                    <li><i class="fas fa-book"></i><strong>Documentaci√≥n API:</strong> Acceso a la documentaci√≥n completa de la API REST</li>
                </ul>

                <h6 class="fw-bold mt-3 mb-2"><i class="fas fa-chart-line me-2"></i>Rentabilidad:</h6>
                <ul class="feature-list">
                    <li><i class="fas fa-chart-line"></i><strong>Rentabilidad Art√≠culos:</strong> An√°lisis de rentabilidad por producto</li>
                    <li><i class="fas fa-chart-bar"></i><strong>Rentabilidad por Pedido:</strong> An√°lisis detallado de rentabilidad por pedido con filtros avanzados</li>
                </ul>

                <h6 class="fw-bold mt-3 mb-2"><i class="fas fa-tools me-2"></i>Gesti√≥n:</h6>
                <ul class="feature-list">
                    <li><i class="fas fa-euro-sign"></i><strong>Gesti√≥n PCP:</strong> Administra los Precios de Coste al Proveedor (PCP) de los art√≠culos</li>
                    <li><i class="fas fa-map-marker-alt"></i><strong>C√≥digos Postales:</strong> Gestiona la asignaci√≥n autom√°tica de c√≥digos postales a provincias</li>
                    <li><i class="fas fa-user-tie"></i><strong>Asignaciones Comerciales:</strong> Asigna comerciales a clientes y zonas de forma masiva o individual</li>
                    <li><i class="fas fa-terminal"></i><strong>Logs del Servidor:</strong> Visualiza los logs del sistema para diagn√≥stico y monitoreo</li>
                </ul>

                <h6 class="fw-bold mt-3 mb-2"><i class="fas fa-euro-sign me-2"></i>Configuraci√≥n Comisiones:</h6>
                <ul class="feature-list">
                    <li><i class="fas fa-money-bill"></i><strong>Fijos Mensuales:</strong> Configura los salarios base mensuales por comercial</li>
                    <li><i class="fas fa-chart-line"></i><strong>Presupuestos:</strong> Establece presupuestos mensuales y anuales por comercial</li>
                    <li><i class="fas fa-trophy"></i><strong>Rapeles:</strong> Configura bonificaciones por objetivos alcanzados</li>
                    <li><i class="fas fa-bullseye"></i><strong>Objetivos por Marca:</strong> Define objetivos de venta por marca y comercial</li>
                    <li><i class="fas fa-star"></i><strong>Condiciones Especiales:</strong> Establece comisiones especiales para casos espec√≠ficos</li>
                    <li><i class="fas fa-percent"></i><strong>Config. % Tipo Pedido:</strong> Define porcentajes de comisi√≥n seg√∫n el tipo de pedido</li>
                    <li><i class="fas fa-chart-line"></i><strong>Config. Rappel Presupuesto:</strong> Configura bonificaciones por cumplimiento de presupuesto</li>
                    <li><i class="fas fa-calendar"></i><strong>Config. Fijo Mensual:</strong> Gestiona la configuraci√≥n de salarios fijos</li>
                    <li><i class="fas fa-truck"></i><strong>Config. Desc. Transp.:</strong> Configura descuentos de transporte en comisiones</li>
                </ul>
            </div>

            <div class="highlight-box mt-4">
                <h5 class="fw-bold mb-3"><i class="fas fa-shield-alt me-2"></i>Nota de Seguridad:</h5>
                <p>Las configuraciones administrativas est√°n disponibles solo para usuarios con rol de Administrador. Si necesitas acceso a funciones administrativas, contacta con tu supervisor.</p>
                <p class="mb-0 mt-2"><strong>Acceso:</strong> Todas las configuraciones administrativas est√°n disponibles desde el men√∫ de usuario (tu nombre en la barra superior) cuando tienes permisos de administrador.</p>
            </div>
        </div>

        <!-- Consejos y Mejores Pr√°cticas -->
        <div id="consejos" class="section-card">
            <div class="section-icon">
                <i class="fas fa-lightbulb"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Consejos y Mejores Pr√°cticas</span>
                <span data-lang="it" style="display: none;">Consigli e Best Practice</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Optimiza tu uso del CRM con estos consejos pr√°cticos.</span>
                <span data-lang="it" style="display: none;">Ottimizza il tuo utilizzo del CRM con questi consigli pratici.</span>
            </p>

            <div class="row">
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <strong>Mant√©n los Datos Actualizados</strong>
                        <p class="mt-2 mb-0">Actualiza regularmente la informaci√≥n de clientes para mantener registros precisos.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-calendar-check text-primary me-2"></i>
                        <strong>Programa Visitas con Anticipaci√≥n</strong>
                        <p class="mt-2 mb-0">Utiliza el calendario para planificar tus visitas y nunca olvides una cita importante.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-file-invoice text-info me-2"></i>
                        <strong>Revisa los Pedidos Antes de Guardar</strong>
                        <p class="mt-2 mb-0">Verifica siempre los totales, precios y cantidades antes de confirmar un pedido.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-chart-line text-warning me-2"></i>
                        <strong>Consulta Regularmente las Estad√≠sticas</strong>
                        <p class="mt-2 mb-0">Revisa tus m√©tricas peri√≥dicamente para identificar tendencias y oportunidades.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-search text-secondary me-2"></i>
                        <strong>Utiliza los Buscadores Eficientemente</strong>
                        <p class="mt-2 mb-0">Los buscadores inteligentes te ayudan a encontrar clientes y art√≠culos r√°pidamente.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-mobile-alt text-success me-2"></i>
                        <strong>Acceso desde M√≥vil</strong>
                        <p class="mt-2 mb-0">La aplicaci√≥n es responsive, puedes acceder desde tu smartphone o tablet con la misma funcionalidad.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-card">
                        <i class="fas fa-book text-primary me-2"></i>
                        <strong>Consulta el Manual</strong>
                        <p class="mt-2 mb-0">Accede al Manual de Instrucciones desde tu perfil cuando necesites ayuda o refrescar conocimientos.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manual de Instrucciones -->
        <div id="manual" class="section-card">
            <div class="section-icon">
                <i class="fas fa-book"></i>
            </div>
            <h2 class="fw-bold mb-4">
                <span data-lang="es">Manual de Instrucciones</span>
                <span data-lang="it" style="display: none;">Manuale di Istruzioni</span>
                <span class="role-badge all" data-lang="es">Todos</span>
                <span class="role-badge all" data-lang="it" style="display: none;">Tutti</span>
            </h2>
            <p class="lead mb-4">
                <span data-lang="es">Esta gu√≠a completa est√° disponible en todo momento desde tu perfil de usuario.</span>
                <span data-lang="it" style="display: none;">Questa guida completa √® disponibile in qualsiasi momento dal tuo profilo utente.</span>
            </p>

            <div class="highlight-box">
                <h5 class="fw-bold mb-3"><i class="fas fa-info-circle me-2"></i>Acceso R√°pido:</h5>
                <p>Puedes acceder a este manual de instrucciones en cualquier momento desde:</p>
                <ul class="feature-list">
                    <li><i class="fas fa-user-circle"></i><strong>Men√∫ de Usuario:</strong> Haz clic en tu nombre en la barra superior ‚Üí "Manual de Instrucciones"</li>
                    <li><i class="fas fa-user"></i><strong>Tu Perfil:</strong> Accede a "Mi Perfil" ‚Üí Bot√≥n "Manual de Instrucciones"</li>
                    <li><i class="fas fa-link"></i><strong>URL Directa:</strong> <code>/dashboard/manual-instrucciones</code></li>
                </ul>
                <p class="mb-0 mt-3">Este manual se actualiza regularmente con las nuevas funcionalidades y mejoras del sistema.</p>
            </div>

            <div class="step-card mt-4">
                <span class="step-number">üí°</span>
                <strong>Caracter√≠sticas del Manual</strong>
                <p class="mt-2 mb-0">El manual incluye navegaci√≥n por secciones, b√∫squeda r√°pida mediante el √≠ndice, bot√≥n "Subir arriba" para navegaci√≥n f√°cil, y dise√±o responsive para acceso desde cualquier dispositivo.</p>
            </div>
        </div>

        <!-- Footer de la Gu√≠a -->
        <div class="section-card text-center">
            <h3 class="fw-bold mb-3">
                <span data-lang="es">¬øNecesitas Ayuda?</span>
                <span data-lang="it" style="display: none;">Hai Bisogno di Aiuto?</span>
            </h3>
            <p class="lead mb-4">
                <span data-lang="es">Si tienes preguntas o necesitas soporte adicional, contacta con tu administrador del sistema.</span>
                <span data-lang="it" style="display: none;">Se hai domande o hai bisogno di supporto aggiuntivo, contatta il tuo amministratore di sistema.</span>
            </p>
            <a href="/dashboard" class="btn btn-manual btn-lg me-2">
                <i class="fas fa-arrow-left me-2"></i>
                <span data-lang="es">Volver al Dashboard</span>
                <span data-lang="it" style="display: none;">Torna alla Dashboard</span>
            </a>
            <a href="/dashboard/perfil" class="btn btn-outline-primary btn-lg">
                <i class="fas fa-user-circle me-2"></i>
                <span data-lang="es">Mi Perfil</span>
                <span data-lang="it" style="display: none;">Il Mio Profilo</span>
            </a>
        </div>
    </div>

    <!-- Bot√≥n Subir Arriba -->
    <button id="scrollToTop" class="scroll-to-top" aria-label="Subir arriba">
        <i class="fas fa-arrow-up"></i>
    </button>
    <script>
        // Actualizar aria-label del bot√≥n seg√∫n idioma
        function updateScrollButtonLabel() {
            const btn = document.getElementById('scrollToTop');
            if (currentLang === 'es') {
                btn.setAttribute('aria-label', 'Subir arriba');
            } else {
                btn.setAttribute('aria-label', 'Torna su');
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <%- include('../partials/navbar-scripts') %>
    <script>
        // Sistema de cambio de idioma con banderas
        document.addEventListener('DOMContentLoaded', function() {
            // Esperar un poco para asegurar que todo est√© cargado
            setTimeout(function() {
                let switchContainer = document.getElementById('languageSwitchContainer');
                
                // Si no existe, crearlo
                if (!switchContainer) {
                    console.log('üîß [IDIOMA] Creando contenedor de banderas...');
                    const body = document.body;
                    switchContainer = document.createElement('div');
                    switchContainer.id = 'languageSwitchContainer';
                    switchContainer.innerHTML = '<img src="/images/bandera-es.jpg" alt="Espa√±ol" class="flag-image active" id="flagSpain" title="Espa√±ol" data-lang="es"><img src="/images/bandera-it.jpg" alt="Italiano" class="flag-image" id="flagItaly" title="Italiano" data-lang="it">';
                    body.appendChild(switchContainer);
                }
                
                // Forzar visibilidad del contenedor - Esquina superior izquierda del banner
                switchContainer.style.cssText = 'position: absolute !important; top: 20px !important; left: 20px !important; z-index: 1000 !important; background: #ffffff !important; padding: 10px 14px !important; border-radius: 25px !important; box-shadow: 0 8px 25px rgba(0,0,0,0.5) !important; border: 3px solid #0b891b !important; display: flex !important; align-items: center !important; gap: 12px !important; justify-content: center !important; visibility: visible !important; opacity: 1 !important; pointer-events: auto !important;';
                
                console.log('‚úÖ [IDIOMA] Contenedor de banderas configurado');
                console.log('üîç [IDIOMA] Z-index:', window.getComputedStyle(switchContainer).zIndex);
                console.log('üîç [IDIOMA] Position:', window.getComputedStyle(switchContainer).position);
                console.log('üîç [IDIOMA] Top:', window.getComputedStyle(switchContainer).top);
                console.log('üîç [IDIOMA] Display:', window.getComputedStyle(switchContainer).display);
                console.log('üîç [IDIOMA] Visibility:', window.getComputedStyle(switchContainer).visibility);

                // Event listeners para las banderas
                const spainFlag = document.getElementById('flagSpain');
                const italyFlag = document.getElementById('flagItaly');
                
                if (spainFlag && italyFlag) {
                    spainFlag.addEventListener('click', function() {
                        console.log('üá™üá∏ [IDIOMA] Cambiando a Espa√±ol');
                        changeLanguage('es');
                    });
                    
                    italyFlag.addEventListener('click', function() {
                        console.log('üáÆüáπ [IDIOMA] Cambiando a Italiano');
                        changeLanguage('it');
                    });
                    console.log('‚úÖ [IDIOMA] Event listeners configurados');
                } else {
                    console.error('‚ùå [IDIOMA] Banderas no encontradas');
                }
            }, 100);
        });

        // ============================================
        // SISTEMA DE CAMBIO DE IDIOMA
        // ============================================
        const translations = {
            es: {
                // Hero
                heroTitle: "Manual de Instrucciones",
                heroSubtitle: "Gu√≠a completa para el uso del CRM Farmadescanso",
                heroDescription: "Aprende a utilizar todas las funcionalidades de la aplicaci√≥n de forma eficiente",
                
                // √çndice
                indexTitle: "√çndice de Contenidos",
                dashboard: "Dashboard Principal",
                pedidos: "Gesti√≥n de Pedidos",
                clientes: "Gesti√≥n de Clientes",
                visitas: "Programaci√≥n de Visitas",
                articulos: "Cat√°logo de Art√≠culos",
                comisiones: "Comisiones",
                cooperativas: "Cooperativas",
                comerciales: "Comerciales",
                reportes: "Reportes y Estad√≠sticas",
                configuracion: "Configuraci√≥n",
                consejos: "Consejos y Mejores Pr√°cticas",
                manual: "Manual de Instrucciones",
                
                // Permisos
                permisoAdmin: "Solo Administradores",
                permisoComercial: "Comerciales",
                permisoTodos: "Todos los Usuarios",
                
                // Footer
                ayudaTitulo: "¬øNecesitas Ayuda?",
                ayudaTexto: "Si tienes preguntas o necesitas soporte adicional, contacta con tu administrador del sistema.",
                volverDashboard: "Volver al Dashboard",
                miPerfil: "Mi Perfil",
                subirArriba: "Subir arriba"
            },
            it: {
                // Hero
                heroTitle: "Manuale di Istruzioni",
                heroSubtitle: "Guida completa per l'uso del CRM Farmadescanso",
                heroDescription: "Impara a utilizzare tutte le funzionalit√† dell'applicazione in modo efficiente",
                
                // √çndice
                indexTitle: "Indice dei Contenuti",
                dashboard: "Dashboard Principale",
                pedidos: "Gestione Ordini",
                clientes: "Gestione Clienti",
                visitas: "Pianificazione Visite",
                articulos: "Catalogo Articoli",
                comisiones: "Commissioni",
                cooperativas: "Cooperative",
                comerciales: "Commerciali",
                reportes: "Report e Statistiche",
                configuracion: "Configurazione",
                consejos: "Consigli e Best Practice",
                manual: "Manuale di Istruzioni",
                
                // Permisos
                permisoAdmin: "Solo Amministratori",
                permisoComercial: "Commerciali",
                permisoTodos: "Tutti gli Utenti",
                
                // Footer
                ayudaTitulo: "Hai Bisogno di Aiuto?",
                ayudaTexto: "Se hai domande o hai bisogno di supporto aggiuntivo, contatta il tuo amministratore di sistema.",
                volverDashboard: "Torna alla Dashboard",
                miPerfil: "Il Mio Profilo",
                subirArriba: "Torna su"
            }
        };

        // Estado del idioma
        let currentLang = localStorage.getItem('manualLang') || 'es';
        
        // Funci√≥n para cambiar idioma
        function changeLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('manualLang', lang);
            
            // Actualizar estado activo de las banderas
            const flagSpain = document.getElementById('flagSpain');
            const flagItaly = document.getElementById('flagItaly');
            if (flagSpain && flagItaly) {
                if (lang === 'es') {
                    flagSpain.classList.add('active');
                    flagItaly.classList.remove('active');
                } else {
                    flagSpain.classList.remove('active');
                    flagItaly.classList.add('active');
                }
            }
            
            // Ocultar/mostrar elementos seg√∫n idioma
            document.querySelectorAll('[data-lang="es"]').forEach(el => {
                el.style.display = (lang === 'es') ? '' : 'none';
            });
            document.querySelectorAll('[data-lang="it"]').forEach(el => {
                el.style.display = (lang === 'it') ? '' : 'none';
            });
            
            // Actualizar atributo lang del HTML
            document.documentElement.lang = lang;
            
            // Actualizar aria-label del bot√≥n scroll
            updateScrollButtonLabel();
        }
        
        // Inicializar idioma (por defecto espa√±ol)
        changeLanguage(currentLang);

        // Indicador de progreso de scroll y bot√≥n subir arriba
        const scrollToTopBtn = document.getElementById('scrollToTop');
        
        window.addEventListener('scroll', function() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('scrollProgress').style.width = scrolled + '%';
            
            // Mostrar/ocultar bot√≥n subir arriba
            if (winScroll > 300) {
                scrollToTopBtn.classList.add('show');
            } else {
                scrollToTopBtn.classList.remove('show');
            }
        });

        // Funcionalidad del bot√≥n subir arriba
        scrollToTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Smooth scroll para los enlaces del √≠ndice
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Animaci√≥n de aparici√≥n al hacer scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section-card').forEach(card => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(card);
        });
    </script>
</body>
</html>
